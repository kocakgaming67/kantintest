<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Riwayat Pesanan</title>
  <style>
    body{
      margin:0; padding:20px; font-family:"Poppins",sans-serif; color:white;
      background: linear-gradient(135deg,#1a2a6c,#b21f1f,#fdbb2d);
      background-size:300% 300%; animation: gradientMove 10s ease infinite;
    }
    @keyframes gradientMove { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
    h1{ text-align:center; margin-bottom:10px; }
    #user{ text-align:center; opacity:.9; margin-bottom:20px; }

    #history{ max-width:700px; margin:0 auto; display:flex; flex-direction:column; gap:16px; }
    .card{
      background:rgba(255,255,255,0.12); border:1px solid rgba(255,255,255,0.2);
      border-radius:14px; padding:14px; backdrop-filter:blur(10px);
    }
    .card h3{ margin:0 0 6px; font-size:18px; }
    .card p{ margin:4px 0; }
    .empty{ text-align:center; opacity:.9; margin-top:40px; }
  </style>
</head>
<body>
  <h1>üßæ Riwayat Pesanan</h1>
  <div id="user"></div>
  <div id="history"></div>

  <script>
    const nama = localStorage.getItem("nama");
    const kelas = localStorage.getItem("kelas");
    const userEl = document.getElementById("user");
    const listEl = document.getElementById("history");

    if(!nama || !kelas){
      userEl.innerHTML = "<p>Nama/Kelas belum diisi. Silakan login dulu.</p>";
      listEl.innerHTML = "";
    } else {
      userEl.innerHTML = `<p>üë§ ${nama} ‚Ä¢ Kelas ${kelas}</p>`;
      const orders = JSON.parse(localStorage.getItem("orders")||"[]")
        .filter(o => o.nama === nama && o.kelas === kelas)
        .sort((a,b)=> b.id - a.id);

      if(orders.length===0){
        listEl.innerHTML = "<p class='empty'>Belum ada riwayat pesanan.</p>";
      } else {
        listEl.innerHTML = "";
        orders.forEach(o=>{
          const pesananList = o.pesanan.map(i=>`${i.menu} x${i.jumlah}`).join(", ");
          const d = new Date(o.id);
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <h3>üóìÔ∏è ${d.toLocaleString()}</h3>
            <p>üçΩ ${pesananList}</p>
            <p>üí∞ Total: Rp${o.total.toLocaleString()}</p>
          `;
          listEl.appendChild(card);
        });
      }
    }
  </script>
</body>
</html>
